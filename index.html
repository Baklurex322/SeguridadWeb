<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="css.css">
</head>
<body>
  <script src="server.js"></script>
<div class="form-container">
    <form id="myForm" id="loginForm" novalidate>

      <div class="cont">
        <label for="name">Nombre:</label>
      <input type="text" id="password" name="name" required minlength="3" maxlength="30"  pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ ]+"  placeholder="Tu nombre" />

      </div>

      <div class="cont">
        <label for="email">Correo electrónico:</label>
      <input type="email" id="correo" name="email" required minlength="10" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-z]{2,}$" required maxlength="30" placeholder="ejemplo@correo.com" />

      </div>

      <div class="cont">
        <label for="age">Edad:</label>
      <input type="text" id="edad" name="edad" maxlength="2" oninput="this.value = this.value.replace(/[^0-9]/g, '')" />

      </div>
     
      <div class="cont">
         <label for="message">Mensaje: (100 letras)</label>
      <textarea id="message" name="message" pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ ]+" required minlength="5" maxlength="100" placeholder="Escribe tu mensaje aquí"></textarea>
<div class="contador" style="color: aliceblue;">
    Caracteres: <span id="contador" style="color: aliceblue;">100</span>
  </div>
      </div>
      <button type="submit">Enviar</button>
    </form>
  </div>
<script>
document.getElementById("loginForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  
  const correo = document.getElementById("correo").value;
  const password = document.getElementById("password").value;

  const res = await fetch("/.netlify/functions/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ correo, password })
  });

  const data = await res.json();
  if (data.success) {
    // 🔑 acceso correcto → redirige
    window.location.href = "/hola.html";
  } else {
    alert("Correo o contraseña incorrectos");
  }
});
</script>
  <script>
    const textarea = document.getElementById('message');
    const contador = document.getElementById('contador');

    textarea.addEventListener('input', () => {
      contador.textContent = 100-textarea.value.length;
    });
  </script>
  <script>
    const form = document.getElementById('myForm');

    form.addEventListener('submit', function(event) {
      if (!form.checkValidity()) {
        event.preventDefault(); // Evita envío si hay errores
        alert('Por favor, rellena correctamente todos los campos.');
      }
    });
  </script>
</body>
</html>